window.onload=function(){let t={timestamp:0,progress:0,scroll:0,lastSave:null},e=document.createElement("aside");e.id="sidePanel",e.innerHTML='<div id="progressBar">\n\t\t\t<div id="meterWrap">\n\t\t\t\t<div id="meter"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div id="stats">\n\t\t\t<table>\n\t\t\t\t<tr>\n\t\t\t\t\t<th colspan="2">Progress</th>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td id="percentTotal" class="number">0.0%</td>\n\t\t\t\t\t<td id="percentSession" class="green number">0.0</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<th colspan="2">Time</th>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>Total:</td>\n\t\t\t\t\t<td id="timeTotal" class="number">00:00:00</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>Session:</td>\n\t\t\t\t\t<td id="timeSession" class="number">00:00:00</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</div>\n\t\t<div id="saveMessage">\n\t\t\t<p>Error!</p>\n\t\t</div>\n\t\t<div id="saveBtn">\n\t\t\t<div></div>\n\t\t</div>\n\t\t<div id="label">\n\t\t\t<label>Brightness</label>\n\t\t</div>\n\t\t<div id="slider">\t\n\t\t\t<input type="range" value=100 step=1></input>\n\t\t</div>\t\n\t\t<div id="lock">\n\t\t\t<p>&#128275;</p>\n\t\t</div>',document.body.appendChild(e);let n=document.createElement("div");function o(t){return document.getElementById(t)}n.id="popUp",document.body.appendChild(n);let i=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)-window.innerHeight,s=o("percentTotal"),l=o("percentSession"),a=o("timeTotal"),d=o("timeSession"),r=o("meter"),c=o("saveBtn").childNodes[1],u=o("saveMessage").childNodes[1],m=o("slider").childNodes[1],p=o("lock").childNodes[1],v=!1;function g(t){t=Math.floor(t/1e3);let e=[];e[0]=t%60,t-=e[0],t=Math.floor(t/60),e[1]=t%60,t-=e[1],t=Math.floor(t/60),e[2]=t%60;for(let t=0;t<3;t++)e[t]<10&&(e[t]="0"+e[t]);return`${e[2]}:${e[1]}:${e[0]}`}label=o("label").childNodes[1],filePath=decodeURIComponent(window.location.href),mouseX=null,sessionTimestamp=0,startDate=new Date,setInterval((function(){sessionTimestamp=(new Date).getTime()-startDate.getTime(),d.innerHTML=""+g(sessionTimestamp);let e=t.timestamp+sessionTimestamp;a.innerHTML=""+g(e)}),1e3);let f,h=["January","February","March","April","May","June","July","August","September","October","November","December"];function b(t){let e=t.getFullYear(),n=t.getMonth(),o=t.getDate(),i=t.getHours(),s=t.getMinutes();return s<10&&(s="0"+s),i<10&&(i="0"+i),`${o} ${h[n]} ${e}  ${i}:${s}`}function w(){t.scroll=window.pageYOffset,t.timestamp+=sessionTimestamp,t.lastSave=b(new Date),localStorage.setItem(""+filePath,JSON.stringify(t)),localStorage.getItem(""+filePath)?(u.style.color="#87ce57",u.textContent="Saved!"):(u.style.color="red",u.textContent="Error!"),c.classList.add("rotateY"),setTimeout((function(){u.style.visibility="visible"}),600),setTimeout((function(){u.style.visibility="hidden"}),900),setTimeout((function(){c.classList.remove("rotateY")}),1e3),startDate=new Date,console.log("New save: "+b(new Date)),console.log(filePath),console.log(JSON.parse(localStorage.getItem(""+filePath)))}function y(){document.body.style.backgroundColor=`hsl(35, 33%, ${m.value/2+50}%)`}function T(){label.classList.toggle("green"),label.classList.toggle("number")}function L(){n.style.bottom="10px",setTimeout((function(){n.style.bottom="-110px"}),2e3)}window.addEventListener("scroll",(function(){var e,n;t.progress=(100-(i-window.pageYOffset)/(i/100)).toFixed(1),e=t.progress,n=s,e<=0?n.textContent="0.0%":t.progress>=100?n.textContent="100%":n.textContent=e+"%";let o=((window.pageYOffset-t.scroll)/(i/100)).toFixed(1);l.textContent=o<.1&&o>-.1?"0.0":o>=.1?"+"+o:o,r.style.width=t.progress+"%"})),c.addEventListener("click",w),window.onmousemove=function(t){t=t||window.event,mouseX=t.pageX,mouseX>-1&&mouseX<=30&&(e.style.left="0",e.isShowed=!0),mouseX>400&&!v&&(e.style.left="-280px",e.isShowed=!1)},m.addEventListener("input",(function(){y(),label.innerHTML=""+m.value,console.log(m.value)})),m.addEventListener("mouseover",(function(){label.innerHTML=""+m.value,T()})),m.addEventListener("mouseout",(function(){label.innerHTML="Brightness",T()})),p.addEventListener("click",(function(){p.innerHTML=v?"&#128275;":"&#128274;",v=!v})),document.addEventListener("keydown",(function(o){"KeyS"==o.code&&(w(),"-280px"==e.style.left&&(n.innerHTML=`<p>New save:</p>\n\t\t\t\t\t\t\t   \t   <p>${t.lastSave}</p>`,L())),"KeyP"==o.code&&(e.isShowed?(e.style.left="-280px",e.isShowed=!1):(e.style.left="0",e.isShowed=!0)),"ArrowLeft"!=o.code&&"ArrowRight"!=o.code||(clearTimeout(f),"ArrowLeft"==o.code?m.value-=20:m.value=+m.value+20,label.classList.add("number"),label.classList.add("green"),label.innerHTML=""+m.value,y())})),document.addEventListener("keyup",(function(t){"ArrowLeft"!=t.code&&"ArrowRight"!=t.code||(f=setTimeout((function(){label.classList.remove("number"),label.classList.remove("green"),label.innerHTML="Brightness"}),800))})),localStorage.getItem(""+filePath)?(t=JSON.parse(localStorage.getItem(""+filePath)),n.innerHTML=`<p>Loaded save:</p>\n\t\t\t\t\t\t   <p>${t.lastSave}</p>`,r.style.width=t.progress+"%",window.scrollTo(0,t.scroll),startDate=new Date):n.innerHTML="<p>New book</p>\n\t\t\t\t\t\t   <p>Save not found</p>",setTimeout((function(){L()}),1e3)};